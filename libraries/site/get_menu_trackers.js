function direction_parsing(a){if(parseFloat(a)==0||parseFloat(a)==360){return a+" N"}else{if(parseFloat(a)>0&&parseFloat(a)<90){return a+" NE"}else{if(parseFloat(a)==90){return a+" E"}else{if(parseFloat(a)>90&&parseFloat(a)<180){return a+" SE"}else{if(parseFloat(a)==180){return a+" S"}else{if(parseFloat(a)>180&&parseFloat(a)<270){return a+" SW"}else{if(parseFloat(a)==270){return a+" W"}else{if(parseFloat(a)>270&&parseFloat(a)<360){return a+" NW"}}}}}}}}}function getCommand(a,b){if(a=="1"||a=="2"||a=="3"){switch(b){case"1":return"30";break;case"2":return"34";break;case"3":return"3F";break;case"4":return"39";break;case"5":return"38";break;case"6":return"32";break;case"7":return"37";break}}else{if(a=="4"){switch(b){case"1":return"4101";break;case"2":return"4102";break;case"3":return"4105";break;case"4":return"4115";break;case"5":return"4115";break;case"6":return"4902";break}}else{if(a=="5"){switch(b){case"1":return"A10";break;case"2":return"A12";break;case"3":return"B07";break;case"4":return"C01";break;case"5":return"C01";break;case"6":return"F01";break}}else{if(a=="6"){switch(b){case"1":return"4101";break;case"2":return"4102";break;case"3":return"4105";break;case"4":return"4115";break;case"5":return"4115";break;case"6":return"4902";break}}else{if(a=="7"){switch(b){case"1":return"A10";break;case"2":return"A12";break;case"3":return"B07";break;case"4":return"F01";break}}else{if(a=="8"){switch(b){case"1":return"A10";break;case"2":return"A12";break;case"3":return"B07";break;case"4":return"C01";break;case"5":return"C01";break;case"6":return"F01";break}}}}}}}}function Event_parsing_type5(a){switch(a){case"1":return"SOS Pressed";break;case"2":return"Input2 active";break;case"3":return"Input3 active";break;case"4":return"Input4 active";break;case"5":return"Input5 active";break;case"9":return"SOS Released";break;case"10":return"Input2 Inactive";break;case"11":return"Input3 Inactive";break;case"12":return"Input4 Inactive";break;case"13":return"Input5 Inactive";break;case"17":return"Low Battery";break;case"18":return"Low External Power";break;case"19":return"Speeding";break;case"20":return"Enter Geo‐fence";break;case"21":return"Exit Geo‐fence";break;case"22":return"External Power On";break;case"23":return"External Power Off";break;case"24":return"No GPS Signal";break;case"25":return"Get GPS Signal";break;case"26":return"Enter Sleep";break;case"27":return"Exit Sleep";break;case"28":return"GPS Antenna Cut";break;case"29":return"Device Reboot";break;case"30":return"Impact";break;case"31":return"Heartbeat Report";break;case"32":return"Heading Change Report";break;case"33":return"Distance Interval Report";break;case"34":return"Current Location Report";break;case"35":return"Normal";break;case"36":return"Tow Alarm";break;case"37":return"RFID";break;case"39":return"Picture";break;case"65":return"Press Input 1 (SOS) to Call";break;case"66":return"Press Input 2 to Call";break;case"67":return"Press Input 3 to Call";break;case"68":return"Press Input 4 to Call";break;case"69":return"Press Input 5 to Call";break;case"70":return"Reject Incoming Call";break;case"71":return"Report Location after Incoming Call";break;case"72":return"Auto Answer Incoming Call";break;case"73":return"Listen‐in (voice monitoring)";break}}function Event_parsing_type6(a){switch(a){case 0:return"Normal";break;case 1:return"Input 1 active";break;case 2:return"Input 2 active";break;case 3:return"Input 3 active";break;case 4:return"Input 4 active";break;case 5:return"Input 5 active";break;case 10:return"Low battery alarm";break;case 11:return"Speeding alarm";break;case 12:return"Movement alarm";break;case 13:return"Alarm of tracker entering Geo-fence scope";break;case 14:return"Alarm of tracker being turned on";break;case 15:return"Alarm of tracker entering GPS blind area";break;case 16:return"Alarm of tracker exiting GPS blind area";break;case 31:return"Input 1 inactive";break;case 32:return"Input 2 inactive";break;case 33:return"Input 3 inactive";break;case 34:return"Input 4 inactive";break;case 35:return"Input 5 inactive";break;case 50:return"External power cut alarm";break;case 52:return"Veer report";break;case 53:return"GPS antenna cut alarm ";break;case 63:return"Distance report";break}}function Event_parsing_typeNR008(a){switch(a){case 80:return"Normal";break;case 81:return"SOS Alarm";break;case 82:return"Over Speed Alarm";break;case 83:return"Geo-Fence Alarm";break;case 89:return"External Power Off";break}}function fuel_Percentage_Left(a){return Math.round((a/((1024*2)-a))*100*100)/100}function TimestampToDateTime(f,g){var b=new Date((f*1000));var k=-b.getTimezoneOffset()/60;var h=b.getDate();h=h<=9?"0"+h:h;var d=b.getMonth()+1;d=d<=9?"0"+d:d;var a=b.getFullYear();var j=b.getHours()-k+g;j=j<=9?"0"+j:j;var c=b.getMinutes();c=c<=9?"0"+c:c;var e=b.getSeconds();e=e<=9?"0"+e:e;return h+"/"+d+"/"+a+" "+j+":"+c+":"+e}function DateTimeToTimestamp(f,e){var c=f;var g=new Date();var l=-g.getTimezoneOffset()/60;var b=c.split("/")[0];var h=c.split("/")[1]-1;var j=c.split("/")[2].split(" ")[0];var d=c.split("/")[2].split(" ")[1].split(":")[0]-l+e;var k=c.split("/")[2].split(" ")[1].split(":")[1];var a=c.split("/")[2].split(" ")[1].split(":")[2];return new Date(j,h,b,d,k,a,0)}function DateToTimestamp(e){var c=e;var b=new Date();var f=-b.getTimezoneOffset()/60;var a=c.split("/")[0];var d=c.split("/")[1]-1;var g=c.split("/")[2].split(" ")[0];return new Date(g,d,a,0,0,0,0)}function Parse_tvar(k,d,n){if(!k.gm_timestamp){id=d.Unit;k.mobile=d.Mobile;k.tdrivername=d.Driver;k.tvehiclereg=d.Vehicle;k.gm_timestamp=k.gm_time;k.gm_time=TimestampToDateTime(k.gm_time,TimeZone);k.gm_inputs=d.Inputs;var m=k.gm_inputs;k.gm_overspeed=parseFloat(d.SpeedLimit);k.gm_address="Double Click";k.gm_speed=parseFloat(k.gm_speed);k.OverSpeedAlarm=false;if(k.gm_speed>k.gm_overspeed){k.OverSpeedAlarm=true}if(k.gm_ori==""){k.gm_ori=direction_parsing(0);k.gm_deg=0}else{k.gm_deg=parseFloat(k.gm_ori);k.gm_ori=direction_parsing(k.gm_ori)}if(d.Mobile){k.caption=k.tvehiclereg}else{if($("#iconcaption").val()=="0"){k.caption=k.tvehiclereg}else{if($("#iconcaption").val()=="1"){k.caption=k.tdrivername}}}k.imgid=d.TrackerImage;k.gm_mileagelimit=parseFloat(d.MileageLimit);k.gm_mileageinit=parseFloat(d.MileageInit);k.gm_mileagereset=parseFloat(d.MileageReset);k.gm_mileage=parseFloat(k.gm_mileage)+k.gm_mileageinit-k.gm_mileagereset;k.gm_type=d.Type;var p=k.gm_type;if(p=="1"||p=="2"||p=="3"||p=="4"){var b=[];var c=k.gm_data;b=c.split(",");k.gm_input5="n/a";k.gm_output2="n/a";k.gm_output3="n/a";k.gm_output4="n/a";k.gm_output5="n/a";k.gm_fuel="n/a";k.gm_AD2="n/a";switch(b[0]){case"0":k.gm_signal=OFF_LBL;break;case"1":k.gm_signal=ON_LBL;break}switch(b[1]){case"1":k.gm_power=NORMAL_LBL;break;case"2":k.gm_power=OFF_LBL;break;case"3":k.gm_power=LOW_LBL;break;case"4":k.gm_power=ERROR_LBL;break}switch(b[2]){case"1":k.gm_state=HIGH_LBL;break;case"2":k.gm_state=SHORT_LBL;break;case"3":k.gm_state=NORMAL_LBL;break;case"4":k.gm_state=ERROR_LBL;break}k.gm_timeInterval=b[3];k.gm_GPSQSignal=b[4];k.gm_GSMQSignal=b[5];switch(b[9]){case"0":k.gm_output1=OFF_LBL;break;case"1":k.gm_output1=ON_LBL;break}switch(b[14]){case"0":k.gm_input1=OFF_LBL;break;case"1":k.gm_input1=ON_LBL;break}switch(b[15]){case"0":k.gm_input2=OFF_LBL;break;case"1":k.gm_input2=ON_LBL;break}switch(b[16]){case"0":k.gm_input3=OFF_LBL;break;case"1":k.gm_input3=ON_LBL;break}switch(b[17]){case"0":k.gm_input4=OFF_LBL;break;case"1":k.gm_input4=ON_LBL;break}if(k.gm_timeInterval=="0"){k.gm_timeInterval="10"}RTinterval=k.gm_timeInterval}else{if(p=="5"){var b=[];var c=k.gm_data;b=c.split(",");k.gm_state=Event_parsing_type5(b[1]);k.gm_GPSQSignal=b[2];k.gm_GSMQSignal=b[3];k.gm_fuel=fuel_Percentage_Left(parseFloat(b[25]));k.gm_power="n/a";k.gm_input3="n/a";k.gm_input4="n/a";k.gm_input5="n/a";k.gm_output2="n/a";k.gm_output3="n/a";k.gm_output4="n/a";k.gm_output5="n/a";k.gm_AD2="n/a";k.gm_timeInterval="n/a";switch(b[0]){case"0":k.gm_signal=OFF_LBL;break;case"1":k.gm_signal=ON_LBL;break}switch(b[17]){case"0":k.gm_input1=OFF_LBL;break;case"1":k.gm_input1=ON_LBL;break}switch(b[18]){case"0":k.gm_input2=OFF_LBL;break;case"1":k.gm_input2=ON_LBL;break}switch(b[9]){case"1":k.gm_output1=OFF_LBL;break;case"0":k.gm_output1=ON_LBL;break}}else{if(p=="6"){k.gm_unit=id;var b=[];var c=k.gm_data;b=c.split("|");k.gm_state=Event_parsing_type6(parseInt(b[8]));k.gm_GSMQSignal=parseInt(b[6],16);k.gm_fuel=fuel_Percentage_Left(parseInt(b[4].split(",")[0],16));k.gm_AD2=fuel_Percentage_Left(parseInt(b[4].split(",")[1],16));k.gm_power="n/a";k.gm_timeInterval="n/a";k.gm_GPSQSignal="n/a";switch(b[0]){case"0":k.gm_signal=OFF_LBL;break;case"1":k.gm_signal=ON_LBL;break}switch(b[3].substr(7,1)){case"0":k.gm_input1=OFF_LBL;break;case"1":k.gm_input1=ON_LBL;break}if(m=="25"){switch(b[3].substr(6,1)){case"0":k.gm_input5=ON_LBL;break;case"1":k.gm_input5=OFF_LBL;break}switch(b[3].substr(3,1)){case"0":k.gm_input2=OFF_LBL;break;case"1":k.gm_input2=ON_LBL;break}}else{switch(b[3].substr(6,1)){case"0":k.gm_input2=ON_LBL;break;case"1":k.gm_input2=OFF_LBL;break}switch(b[3].substr(3,1)){case"0":k.gm_input5=OFF_LBL;break;case"1":k.gm_input5=ON_LBL;break}}switch(b[3].substr(5,1)){case"0":k.gm_input3=ON_LBL;break;case"1":k.gm_input3=OFF_LBL;break}switch(b[3].substr(4,1)){case"0":k.gm_input4=OFF_LBL;break;case"1":k.gm_input4=ON_LBL;break}switch(b[3].substr(15,1)){case"0":k.gm_output1=ON_LBL;break;case"1":k.gm_output1=OFF_LBL;break}switch(b[3].substr(14,1)){case"0":k.gm_output2=ON_LBL;break;case"1":k.gm_output2=OFF_LBL;break}switch(b[3].substr(13,1)){case"0":k.gm_output3=ON_LBL;break;case"1":k.gm_output3=OFF_LBL;break}switch(b[3].substr(12,1)){case"0":k.gm_output4=ON_LBL;break;case"1":k.gm_output4=OFF_LBL;break}switch(b[3].substr(11,1)){case"0":k.gm_output5=ON_LBL;break;case"1":k.gm_output5=OFF_LBL;break}}else{if(p=="7"){var b=[];var c=k.gm_data;b=c.split(",");k.gm_state=Event_parsing_type5(b[1]);k.gm_GPSQSignal=b[2];k.gm_GSMQSignal=b[3];k.gm_fuel=fuel_Percentage_Left(parseFloat(b[25]));k.gm_power="n/a";k.gm_input2="n/a";k.gm_input3="n/a";k.gm_input4="n/a";k.gm_input5="n/a";k.gm_output1="n/a";k.gm_output2="n/a";k.gm_output3="n/a";k.gm_output4="n/a";k.gm_output5="n/a";k.gm_AD2="n/a";k.gm_timeInterval="n/a";switch(b[0]){case"0":k.gm_signal=OFF_LBL;break;case"1":k.gm_signal=ON_LBL;break}switch(b[17]){case"0":k.gm_input1=OFF_LBL;break;case"1":k.gm_input1=ON_LBL;break}}else{if(p=="8"){var b=[];var c=k.gm_data;b=c.split(",");k.gm_state=Event_parsing_type5(b[1]);k.gm_GPSQSignal=b[2];k.gm_GSMQSignal=b[3];k.gm_fuel=fuel_Percentage_Left(parseFloat(b[25]));k.gm_power="n/a";k.gm_input3="n/a";k.gm_input4="n/a";k.gm_input5="n/a";k.gm_output2="n/a";k.gm_output3="n/a";k.gm_output4="n/a";k.gm_output5="n/a";k.gm_AD2="n/a";k.gm_timeInterval="n/a";switch(b[0]){case"0":k.gm_signal=OFF_LBL;break;case"1":k.gm_signal=ON_LBL;break}switch(b[17]){case"0":k.gm_input1=OFF_LBL;break;case"1":k.gm_input1=ON_LBL;break}if(m=="23"){switch(b[19]){case"1":k.gm_input2=ON_LBL;break;case"0":k.gm_input2=OFF_LBL;break}switch(b[18]){case"0":k.gm_input3=OFF_LBL;break;case"1":k.gm_input3=ON_LBL;break}}else{switch(b[18]){case"1":k.gm_input2=ON_LBL;break;case"0":k.gm_input2=OFF_LBL;break}switch(b[19]){case"0":k.gm_input3=OFF_LBL;break;case"1":k.gm_input3=ON_LBL;break}}switch(b[9]){case"1":k.gm_output1=OFF_LBL;break;case"0":k.gm_output1=ON_LBL;break}switch(b[8]){case"1":k.gm_output2=OFF_LBL;break;case"0":k.gm_output2=ON_LBL;break}switch(b[7]){case"1":k.gm_output3=OFF_LBL;break;case"0":k.gm_output3=ON_LBL;break}}else{if(p=="9"){var b=[];var c=k.gm_data;b=c.split(",");if(parseFloat(b[2])=="81"){k.gm_input1=ON_LBL}else{k.gm_input1=OFF_LBL}k.gm_state=Event_parsing_typeNR008(parseFloat(b[2]));k.gm_GPSQSignal="n/a";k.gm_GSMQSignal="n/a";k.gm_fuel="n/a";k.gm_power="n/a";k.gm_input3="n/a";k.gm_input4="n/a";k.gm_input5="n/a";k.gm_output2="n/a";k.gm_output3="n/a";k.gm_output4="n/a";k.gm_output5="n/a";k.gm_AD2="n/a";k.gm_timeInterval="n/a";if(parseFloat(k.gm_lat)!==0&&parseFloat(k.gm_lng)!==0){k.gm_signal=ON_LBL}else{k.gm_signal=OFF_LBL}switch(b[1].substr(1,1)){case"0":k.gm_input2=OFF_LBL;break;case"1":k.gm_input2=ON_LBL;break}switch(b[1].substr(0,1)){case"1":k.gm_output1=ON_LBL;break;case"0":k.gm_output1=OFF_LBL;break}}}}}}}if(!d.Mobile){var j=$(".map"+id).val();if(j=="0"){k.map=MapClass.currMapID}else{k.map=j.split("map")[1]}}else{k.map=0}if(!d.Mobile){if(RealTimeClass.TrackedID==id){k.trackable=true}else{k.trackable=false}}if(d.Mobile){if($("#vehicles").val()==id){k.trackable=true}else{k.trackable=false}}if(n=="realtime"){var l=new Date();var g=DateTimeToTimestamp(k.gm_time,TimeZone);var o=(l.getTime()-g.getTime())/(1000*60*60);if(o>DefaultSettings.inLostMode){k.lostAlarm=true}else{k.lostAlarm=false}if(d.VehicleregExpiry!=""){var h=DateToTimestamp(d.VehicleregExpiry);var f=(h.getTime()-l.getTime())/(24*3600*1000);if(f<0){k.regAlarm=true}else{k.regAlarm=false}}else{k.regAlarm=false}if(d.TrackerExpiry!=""){var a=DateToTimestamp(d.TrackerExpiry);var e=(a.getTime()-l.getTime())/(24*3600*1000);if(e<0){k.ExpAlarm=true}else{k.ExpAlarm=false}}else{k.ExpAlarm=false}}else{k.lostAlarm=false;k.regAlarm=false;k.ExpAlarm=false}if(k.gm_mileage>=k.gm_mileagelimit){k.MileageAlarm=true}else{k.MileageAlarm=false}if(k.gm_signal==OFF_LBL){k.SignalAlarm=true}else{k.SignalAlarm=false}if(k.gm_input1==ON_LBL){k.UrgentAlarm=true}else{k.UrgentAlarm=false}if(k.gm_input2==ON_LBL){k.AccAlarm=true}else{k.AccAlarm=false}k.geoFAlarm=false;k.geoFArea="";if(!d.Mobile){if(document.getElementById("gf_displaycheck").checked==true){for(i in GeoFenceViewer.ID){if(document.getElementById("geofences_list").options[i].selected){if(MapClass.currMap=="gmap"){if(pointInPolygon(latlongPaths(GeoFenceViewer.Data[i]),k.gm_lat,k.gm_lng)==true){k.geoFAlarm=true;k.geoFArea=k.geoFArea+GeoFenceViewer.Name[i];k.geoFID=GeoFenceViewer.ID[i];break}else{k.geoFAlarm=false;k.geoFArea="";k.geoFID=GeoFenceViewer.ID[i]}}else{if(MapClass.currMap=="omap"){if(pointInPolygon(latlongPaths(GeoFenceViewer.Data[i]),k.gm_lat,k.gm_lng)==true){k.geoFAlarm=true;k.geoFArea=k.geoFArea+GeoFenceViewer.Name[i];k.geoFID=GeoFenceViewer.ID[i];break}else{k.geoFAlarm=false;k.geoFArea="";k.geoFID=GeoFenceViewer.ID[i]}}}}}}}if(k.mobile){DefaultSettings.imgsrc="../images/car/";DefaultSettings.alarmimgsrc="../images/alarmsicons/"}if(k.lostAlarm||k.SignalAlarm){k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_lost.gif";if(k.SignalAlarm){k.alarmimg=DefaultSettings.alarmimgsrc+"GPSoff.png"}else{k.alarmimg="none"}}else{if(k.UrgentAlarm){k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_alarm.gif";k.alarmimg=DefaultSettings.alarmimgsrc+"emergency.png"}else{if(parseFloat(k.gm_speed)==0){if(k.AccAlarm){k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_idle.gif";k.alarmimg="none"}else{if(k.geoFAlarm){k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_alarm.gif";k.alarmimg=DefaultSettings.alarmimgsrc+"geo-fence.png"}else{k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_stop.gif";k.alarmimg="none"}}}else{if(k.AccAlarm==false){k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_alarm.gif";k.alarmimg=DefaultSettings.alarmimgsrc+"breakdown.png"}else{if(k.OverSpeedAlarm){k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_alarm.gif";k.alarmimg=DefaultSettings.alarmimgsrc+"speedLimit.png"}else{if(k.geoFAlarm){k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_alarm.gif";k.alarmimg=DefaultSettings.alarmimgsrc+"geo-fence.png"}else{k.img=DefaultSettings.imgsrc+"icon_"+k.imgid+"_driver.gif";k.alarmimg="none"}}}}}}}return k};